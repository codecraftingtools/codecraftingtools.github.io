

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Design &mdash; Code Craftsmen  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tools" href="tools.html" />
    <link rel="prev" title="Philosophy" href="philosophy.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Code Craftsmen
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="vision.html">Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Philosophy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#principles">Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#considerations">Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#application-domains">Application Domains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-structure">Application Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardware-architectures">Hardware Architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operating-systems">Operating Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#concurrent-and-parallel-processing">Concurrent and Parallel Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#programming-language-support">Programming Language Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inter-component-communication-methodology">Inter-Component Communication Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#standardized-component-interfaces">Standardized Component Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging-and-screen-output">Logging and Screen Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timekeeping">Timekeeping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scheduling">Scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-input-and-output">File Input and Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-logging">Data Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-time-environments">Run-time Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-level-code">Application-Level Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-formats">File Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-generation">Code Generation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="foundation.html">Foundation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Code Craftsmen</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/design.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design">
<span id="id1"></span><h1>Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h1>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>In the Code Craftsmen’s view, writing software is currently much more
difficult than it needs to be.  Our hope, and our primary goal, is to
<strong>restore the joy in programming</strong> by developing code crafting tools
that make software:</p>
<ul class="simple">
<li>Easier to read</li>
<li>Easier to write</li>
<li>Easier to maintain</li>
<li>Easier to reuse</li>
</ul>
</div>
<div class="section" id="principles">
<h2>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h2>
<p>There are a few key principles that support these goals and drive our
design strategy, such as:</p>
<ul class="simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">Don’t repeat yourself</a></li>
<li>Design for testability</li>
<li>Documentation is important</li>
<li>Don’t repeat yourself (unless it’s worth saying twice)</li>
</ul>
<p>Although there are surely some other principles worth adding to this
list, the ones listed here play a major role in many of our design
decisions.</p>
</div>
<div class="section" id="considerations">
<h2>Considerations<a class="headerlink" href="#considerations" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will briefly walk through a number of design
considerations that influence the development of our code crafting
tools.</p>
<div class="section" id="application-domains">
<h3>Application Domains<a class="headerlink" href="#application-domains" title="Permalink to this headline">¶</a></h3>
<p>Our tools support the development of software for a wide variety of
application domains, including, but not limited to:</p>
<ul class="simple">
<li>Embedded systems</li>
<li>Hard and soft real-time systems</li>
<li>Open and closed-loop control systems</li>
<li>Hardware testing</li>
<li>Data acquisition</li>
<li>Simulation</li>
<li>Data processing</li>
<li>Data display</li>
<li>Desktop applications</li>
</ul>
<p>Obviously, the code development cycle for some of these domains
(e.g. embedded, real-time, and closed-loop systems) is much more
cumbersome than for others (e.g. non-real-time simulation).  Because
of this, it would be advantageous to develop and test as much code as
possible in the simplified domains before moving into the more complex
ones.</p>
</div>
<div class="section" id="application-structure">
<h3>Application Structure<a class="headerlink" href="#application-structure" title="Permalink to this headline">¶</a></h3>
<p>In order to maximize both our productivity and the quality of our
software, our tools facilitate the development of code that can be
used (and reused) in a wide variety of application domains without
alteration.  The following application structure helps us achieve this
goal by separating the domain-independent code from the
domain-specific code:</p>
<dl class="docutils">
<dt>Components</dt>
<dd>Well-defined software blocks which can, ideally, be used in a
variety of application domains without alteration.  Components
communicate with other components and interact with their
environment through a standardized, domain-independent interface.
It is important to note that when the Code Craftsmen use the term
<em>component</em>, it is rarely in the general sense, but almost always
refers a software block that conforms to a very specific interface.</dd>
<dt>Run-Time Environment</dt>
<dd>Provides components with a standardized interface to run-time
functionality, such as inter-component communication, scheduling,
timing, and logging.  The underlying implementation may be
general-purpose or tailored to a specific application domain or
operating system.</dd>
<dt>Hierarchic Design</dt>
<dd>Multiple components can be instantiated and connected together in
the context of a specific run-time environment to construct
higher-level components and applications.</dd>
<dt>Application Executive</dt>
<dd>Common application-level functionality, such as command-line option
and input-file processing, component configuration and
initialization, and application termination may be handled by a
generalized or domain-specific application executive.</dd>
<dt>Hardware and Operating System Abstraction Layer</dt>
<dd>Provides a uniform, hardware-independent programming interface to
standard operating system functionality.</dd>
<dt>Utility Libraries</dt>
<dd>Traditional procedural routines or object-oriented class libraries
may be used within the implementation of a particular component,
run-time environment, or application executive, but do not factor
into the interface between these code segments.</dd>
</dl>
</div>
<div class="section" id="hardware-architectures">
<h3>Hardware Architectures<a class="headerlink" href="#hardware-architectures" title="Permalink to this headline">¶</a></h3>
<p>Although there are significant differences between some of the
relevant hardware platfoms, our tools enable developers to design
software components that can be deployed on any supported hardware
architecture without source code changes, regardless of the target
instruction set, byte order, or bit width.  This means that any
platform-specific code must be incorporated into a lower-level
abstraction layer, handled by the run-time environment, or
strategically isolated in a few components with abstracted interfaces.
Although we desire to support a broad range of hardware architectures,
the current priority is support for <strong>64-bit x86</strong> and <strong>32-bit ARM</strong>
systems.</p>
</div>
<div class="section" id="operating-systems">
<h3>Operating Systems<a class="headerlink" href="#operating-systems" title="Permalink to this headline">¶</a></h3>
<p>The write-once, run-everywhere philosophy of our tool set also extends
to operating systems, providing a way to develop software components
that are not tied to a particular host OS, but are instead portable to
any supported real-time or non-real-time operating environment without
modification.  In order to achieve this, any OS-specific code must be
incorporated into a lower-level abstraction layer or handled by the
run-time environment.  Although future possibilities are endless, the
current focus is on providing support for:</p>
<ul class="simple">
<li>Standard desktop and embedded Linux</li>
<li>Real-time Linux (PREEMPT_RT)</li>
<li>Real-time Linux (Xenomai/cobalt)</li>
<li>RTEMS</li>
</ul>
</div>
<div class="section" id="concurrent-and-parallel-processing">
<h3>Concurrent and Parallel Processing<a class="headerlink" href="#concurrent-and-parallel-processing" title="Permalink to this headline">¶</a></h3>
<p>Many of our application domains require support for independent
software components executing concurrently, or even simultaneously (in
parallel).  There are several categories of concurrency that we must
consider:</p>
<dl class="docutils">
<dt>Preemptive Multitasking</dt>
<dd>Execution of a task may be forcibly suspended by the operating
system in order to give another task a turn.  Many real-time
systems, for example, have long-running lower-priority tasks that
must be preempted by high-priority short-duration tasks in order to
meet real-time deadlines.  This is typically achieved by creating a
separate operating-system thread or process for each task.  In many
real-time systems, these threads and processes can be assigned
priority values to ensure that high-priority tasks take precedence
over low-priority ones.</dd>
<dt>Cooperative Multitasking</dt>
<dd>Tasks may voluntarily yield execution to other tasks at specific
points in time.  One example of this type of concurrency is a
physics simulation involving several models, where each of these
models must be updated at each time step.</dd>
<dt>Parallel Processing</dt>
<dd>Tasks execute simultaneously on different processors.  Parallel
processing is often used to speed up program execution or perform
several unrelated tasks at once.  In many general-purpose
parallel-processing systems, several operating-system threads or
processes can be executed in parallel.</dd>
</dl>
<p>Our code crafting tools are designed to allow software components to
execute concurrently in all of these environments with minimal effort.
This is critical for real-time applications, but is also useful for
speeding up non-real-time applications by breaking up software into
independent pieces that can run in parallel on separate processors.
Most software components should not need to know anything about
threads, processes, scheduling policies, or priorities.  Our tools
allow these details to be easily specified when low-level components
are instantiated and combined together into a higher-level component
or application.</p>
</div>
<div class="section" id="programming-language-support">
<h3>Programming Language Support<a class="headerlink" href="#programming-language-support" title="Permalink to this headline">¶</a></h3>
<p>At a fundamental level, we require all software components to interact
with their run-time environment via a standardized programming
interface based on C function calls.  Our tools provide a set of
higher-level language-specific bindings, built on top of this C API,
that allow components to be implemented in a way that conforms to the
conventions of each programming language.  This approach allows
software components written in various programming languages to
interoperate with one another in the same run-time environment.  Our
current priority is the development of bindings for <strong>C++</strong> and
<strong>Python</strong>, but we hope to eventually support a host of other
programming languages.</p>
</div>
<div class="section" id="inter-component-communication-methodology">
<h3>Inter-Component Communication Methodology<a class="headerlink" href="#inter-component-communication-methodology" title="Permalink to this headline">¶</a></h3>
<p>For the many reasons described elsewhere in this documentation, our
design approach requires components to communicate with one another in
a standardized way.  There are many mechanisms that could be used to
transfer data between components, each with their own advantages and
disadvantages:</p>
<dl class="docutils">
<dt>Method Calls</dt>
<dd><p class="first">In object-oriented programming languages, data is typically
transferred between objects by having one object pass data to (or
receive data from) another object using method calls (member
functions).  This approach is simple and well understood, but has
many drawbacks:</p>
<ul class="last simple">
<li>Passing data between objects using method calls is not
thread-safe, so data transfer between objects in different threads
typically requires manual, error-prone synchronization.</li>
<li>Objects typically have no way to “send out” information.
Typically, the outputs of an object must be retrieved by a
higher-level object.</li>
<li>Custom top-level glue code must often be written to extract data from
one component and pass it into another.</li>
<li>In languages with strict typing, it is difficult to “connect” objects
that were not designed specifically to work together.</li>
<li>Inter-language operation is usually possible, but tedious to
implement.</li>
</ul>
</dd>
<dt>Callback Functions</dt>
<dd><p class="first">In some object-oriented architectures, objects do attempt to “send
out” data by storing a pointer to an output object and calling a
member-function of that object to send data to that object.  This
approach still has many issues:</p>
<ul class="last simple">
<li>Manual checks may have to be performed to see if a destination
object has been “connected”.</li>
<li>Multiple destination objects are usually not a possibility.</li>
<li>Callback loops can cause issues with non-reentrant code.</li>
</ul>
</dd>
<dt>Shared Memory</dt>
<dd><p class="first">The use of shared memory is a simple, commonly-used, and very
efficient, method of passing data between software components.  In
this scheme, components read input data from and write data to
predetermined shared memory locations.  There are, however, several
major drawbacks to this approach:</p>
<ul class="last simple">
<li>Passing data between components using shared memory is not
thread-safe, so data transfer between components in different
threads typically requires manual, error-prone synchronization.</li>
<li>Memory usage may be high.</li>
<li>If pointers are used to specify the location of input or output
variables, manual checks may be required to make sure these
pointers have been initialized.</li>
<li>Some shared memory communication schemes use global variable
locations, which introduces a host of well-known issues.</li>
</ul>
</dd>
<dt>Message Passing</dt>
<dd><p class="first">In message-passing systems, information is transmitted by passing
data structures from one software component to another through some
sort of message delivery framework.  The messaging framework
typically employs some form of message queues to synchronize the
data transmission.  Depending on the design of the system, data may
be passed by reference or by value. Message-passing systems have a
number of benefits:</p>
<ul class="last simple">
<li>Many implementations support the transmission of messages between
threads, or even processes, without any manual synchronization.</li>
<li>Multiple messaging system implementations can be supported with no
changes to the software components.  The messaging system
implementation can be chosen at compile, link or run time.</li>
<li>The message sender does not need to know anything about the
receiver.  Zero, one, or more message receivers can be connected
to a single sender.</li>
<li>The message sender and receiver only need to agree on the format
of the data structure being passed, not the class hierarchy.</li>
<li>The amount of custom top-level glue code required to transfer data
between components is minimal.</li>
<li>The message-passing concept maps naturally to many communication
channels, such as network sockets, file I/O, serial and block
device I/O, UNIX pipes, Qt signals and slots, event-driven
systems, function calls, and message queues.</li>
<li>Many real-time operating systems offer native support for message
queues.</li>
<li>Inter-language operation is straightforward to implement.</li>
</ul>
</dd>
</dl>
<p>Although message-passing systems can be more complex and slower than
some of the alternatives, the versatility offered by this approach
makes it a great choice, given our design goals and application
domains.  For this reason, we haven chosen to use <strong>message-passing as
the standard means of inter-component communication</strong> in our software.</p>
</div>
<div class="section" id="standardized-component-interfaces">
<h3>Standardized Component Interfaces<a class="headerlink" href="#standardized-component-interfaces" title="Permalink to this headline">¶</a></h3>
<p>[Document the importance of this.]</p>
</div>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>Since all but the simplest of software components require some type of
configuration, our tools provide built-in support for this operation.
In our system, software components are merely responsible for
declaring the names, types, and default values of their configurable
properties.  The actual assignment of these properties is typically
handled by the run-time environment or application executive.
This approach allows all of the software components in an application
to be configured in a uniform way, and the configuration code can be
leveraged across many applications.</p>
<p>Since message-passing was chosen as the standardized means of
inter-component communication, it makes sense that components should
be configured by sending them messages.  Under the hood, a
configuration property is simply a member variable whose value can be
set via an input message.  Typically, components also send an output
message when the value of a property changes so that the value of one
property can by tied to the value of another.</p>
<p>Since components delegate the configuration process to the outside
world, configuration may be handled in various ways, depending on the
application.  For embedded applications with no user interface or
filesystem, configuration may simply consist of specifying property
values at compile-time.  This can be done by instantiating derived
components that override default property values or by making
connections that tie the value of one property to another.  In other
applications, software components may be configured through the use of
command-line options, input files, or a GUI dialog box.  Since
component properties are all defined in a uniform way, the code that
handles the configuration does not need to be hand-coded for each
application.</p>
<p>So far, we have only considered the simple assignment of properties.
In addition to the fundamental property attributes (i.e. name, type,
default value), components can also declare additional attributes to
supply information that may be useful in certain run-time
environments.  The declaration of min/max value constraints could be
used to automatically check that run-time property assignments are
within the expected range.  Unit constraints could be used to check
that the user has supplied values with the proper units or even
perform automatic conversions.  Statistical constraints, like random
distribution parameters, could be used by a simulation engine to make
Monte Carlo draws.  The possibilities are endless.</p>
</div>
<div class="section" id="logging-and-screen-output">
<h3>Logging and Screen Output<a class="headerlink" href="#logging-and-screen-output" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="timekeeping">
<h3>Timekeeping<a class="headerlink" href="#timekeeping" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="scheduling">
<h3>Scheduling<a class="headerlink" href="#scheduling" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="file-input-and-output">
<h3>File Input and Output<a class="headerlink" href="#file-input-and-output" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="data-logging">
<h3>Data Logging<a class="headerlink" href="#data-logging" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="run-time-environments">
<h3>Run-time Environments<a class="headerlink" href="#run-time-environments" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="application-level-code">
<h3>Application-Level Code<a class="headerlink" href="#application-level-code" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="file-formats">
<h3>File Formats<a class="headerlink" href="#file-formats" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="code-generation">
<h3>Code Generation<a class="headerlink" href="#code-generation" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tools.html" class="btn btn-neutral float-right" title="Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="philosophy.html" class="btn btn-neutral" title="Philosophy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, 2019 Jeffrey A. Webb

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
    /* Sidebar */
    .wy-nav-side {
      /*width:0px;*/
    }
    .wy-side-scroll {
      /*width:0px;*/
    }
    .wy-breadcrumbs {
      visibility: hidden;
    }
    /*
    [role=search] {
    visibility: hidden;
    }
    [role=navigation] {
    visibility: hidden;
    }
    */
    h1 {
    font-size:400%;
    }
  </style>


</body>
</html>